<div class="form-container">
  <h2>{{ titulo }}</h2>

  <form [formGroup]="form" (ngSubmit)="aceptar()">

    <!-- ❌ ELIMINADO: Campo de selección de usuario (ahora está oculto y automático) -->

    <!-- Título -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Título de la Solicitud</mat-label>
      <input 
        matInput
        type="text" 
        formControlName="titulo" 
        placeholder="Ej. Problema con registro de transporte"
      >
      <mat-error *ngIf="form.get('titulo')?.hasError('required')">
        El título es obligatorio
      </mat-error>
      <mat-error *ngIf="form.get('titulo')?.hasError('maxlength')">
        Máximo 100 caracteres
      </mat-error>
    </mat-form-field>

    <!-- Apartado -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Apartado/Sección</mat-label>
      <mat-select formControlName="Apartado" placeholder="Selecciona un apartado">
        <mat-option *ngFor="let a of apartados" [value]="a">
          {{ a }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="form.get('Apartado')?.hasError('required')">
        Debes seleccionar un apartado
      </mat-error>
    </mat-form-field>

    <!-- Descripción -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Descripción del Problema</mat-label>
      <textarea 
        matInput
        formControlName="descripcion" 
        rows="5"
        placeholder="Describe detalladamente el problema que enfrentas (mínimo 20 palabras, máximo 255 palabras)..."
      ></textarea>
      <mat-hint [class.warning]="!validarPalabras()" [class.success]="validarPalabras()">
        Palabras: {{ contarPalabras() }} / Mínimo: 20 - Máximo: 255
      </mat-hint>
      <mat-error *ngIf="form.get('descripcion')?.hasError('required')">
        La descripción es obligatoria
      </mat-error>
    </mat-form-field>

    <!-- Fecha (solo lectura) -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Fecha del Reporte</mat-label>
      <input 
        matInput 
        [matDatepicker]="picker" 
        formControlName="fechahora"
        [readonly]="true"
        placeholder="Fecha actual"
      >
      <mat-hint>Fecha automática del día de hoy</mat-hint>
      <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker disabled="false"></mat-datepicker>
    </mat-form-field>

    <!-- Botones -->
    <div class="acciones">
      <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid || !validarPalabras()">
        Guardar
      </button>
      <button mat-button color="warn" type="button" routerLink="/home/soportesolicitudes/listar">
        Cancelar
      </button>
    </div>

  </form>
</div>